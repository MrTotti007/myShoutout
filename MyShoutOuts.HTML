<html>

<head>
    <title>Streamer.bot Shout Out Player</title>
    <script>
        function showVideo() {
            const videoElement = document.getElementById('videoplayer');
            videoElement.style.visibility = "visible";
        }

        function shoutout() {
            const urlParams = new URLSearchParams(window.location.search);
            const user = urlParams.get('user');
            const image = urlParams.get('image');
            const video = urlParams.get('video'); // Should contain the embed URL with Twitch's clip ID
            const time = urlParams.get('time');

            // Set the user image
            document.getElementById('imagebox2').innerHTML = `<img src="${image}" width="100%"/>`;

            // Set the embed URL with autoplay
            const embedUrl = `${video}&autoplay=true`;
            console.log("Embed URL:", embedUrl);

            // Update the video iframe for Twitch clip embedding
            const videoElement = document.getElementById('videoplayer');
            videoElement.style.visibility = "hidden"; // Initially hidden
            videoElement.src = embedUrl;

            // Ensure visibility and autoplay after a small delay
            setTimeout(() => {
                showVideo();
            }, 1000); // Delay for video loading
        }

        function cleanup() {
            document.getElementById('videoplayer').src = ""; // Clear video src
            document.getElementById('imagebox2').innerHTML = ""; // Clear user image
        }
    </script>
</head>

<body onload="shoutout();">
    <div id="videocontainer" style="position:absolute; left: 0px; top: 0px; width: 100%; z-index: 10; text-align: center;">
        <iframe id='videoplayer' style="width: 100%; height: 100%;" frameborder="0" allow="autoplay"></iframe>
    </div>
    <div id="imagebox2"
        style="position:absolute; height: 66%; width: 37.5%; text-align: center; z-index: 1; left: 50%; top: 50%; transform: translate(-50%, -50%);">
    </div>
</body>

</html>
